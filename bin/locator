#!/bin/bash

adb shell uiautomator dump                                                            
adb pull /sdcard/window_dump.xml .

echo "## finding node $1.."
element_info=$(xmlstarlet sel -t -c "//node[@text=\"$1\"]" window_dump.xml)

echo "## finding location.."
bounds=$(echo $element_info | grep -o 'bounds="\[[0-9]*,[0-9]*\]\[[0-9]*,[0-9]*\]"')

x=$(echo "$bounds" | sed -n 's/bounds="\[\([0-9]*\),[0-9]*\]\[[0-9]*,[0-9]*\]"/\1/p')
y=$(echo "$bounds" | sed -n 's/bounds="\[[0-9]*,\([0-9]*\)\]\[[0-9]*,[0-9]*\]"/\1/p')

echo "## node location X: $x, Y: $y"
adb shell input tap $x $y
